package source

import (
	"github.com/Escape-Technologies/cloudfinder/internal/log"
	"github.com/Escape-Technologies/cloudfinder/pkg/provider"
)

type Ovh struct{}

// Source: https://ipinfo.io/AS16276#block-ranges
var ovhRanges = [...]string{
	"135.125.0.0/17",
	"135.125.128.0/17",
	"135.148.0.0/17",
	"135.148.128.0/17",
	"137.74.0.0/16",
	"139.99.0.0/17",
	"139.99.128.0/17",
	"141.227.128.0/24",
	"141.227.130.0/24",
	"141.227.132.0/24",
	"141.227.134.0/24",
	"141.227.136.0/24",
	"141.227.138.0/24",
	"141.227.140.0/24",
	"141.94.0.0/16",
	"141.95.0.0/17",
	"141.95.128.0/17",
	"142.4.192.0/19",
	"142.44.128.0/17",
	"142.44.140.0/24",
	"144.217.0.0/16",
	"145.239.0.0/16",
	"146.59.0.0/16",
	"146.59.0.0/17",
	"147.135.0.0/17",
	"147.135.128.0/17",
	"148.113.0.0/18",
	"148.113.128.0/17",
	"149.202.0.0/16",
	"149.56.0.0/16",
	"151.80.0.0/16",
	"15.204.0.0/17",
	"15.204.128.0/17",
	"152.228.128.0/17",
	"15.235.0.0/17",
	"15.235.128.0/17",
	"158.69.0.0/16",
	"162.19.0.0/17",
	"162.19.128.0/17",
	"164.132.0.0/16",
	"167.114.0.0/17",
	"167.114.128.0/18",
	"167.114.192.0/19",
	"176.31.0.0/16",
	"178.32.0.0/15",
	"185.15.68.0/22",
	"185.45.160.0/22",
	"188.165.0.0/16",
	"192.240.152.0/21",
	"192.31.246.0/24",
	"192.95.0.0/18",
	"192.99.0.0/16",
	"192.99.65.0/24",
	"193.70.0.0/17",
}

func (a Ovh) GetIPRanges() []*IPRange {
	log.Info("Using static ovh ip ranges")

	ranges := make([]*IPRange, 0)
	for _, cdir := range ovhRanges {
		network, cat := ParseCIDR(cdir)
		ranges = append(ranges, &IPRange{
			Network:  network,
			Cat:      cat,
			Provider: provider.Ovh,
		})
	}

	return ranges
}
